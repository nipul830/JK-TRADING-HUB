<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>JK Trading Hub</title>

<!-- TradingView library -->
<script src="https://s3.tradingview.com/tv.js"></script>

<style>
  :root{
    --bg:#0f1218; --panel:#141922; --muted:#9aa3b2; --text:#e6ebf2;
    --primary:#2d6cff; --pill:#1e2430; --accent:#36c98c; --danger:#e15b64;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{margin:0;background:var(--bg);color:var(--text);font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;}
  .wrap{max-width:1080px;margin:0 auto;padding:0 12px 48px}

  /* Navbar */
  .nav{position:sticky;top:0;z-index:20;background:rgba(15,18,24,.9);backdrop-filter:saturate(160%) blur(8px);
       border-bottom:1px solid #1e2430}
  .nav-inner{display:flex;align-items:center;gap:12px;padding:10px 12px}
  .brand{display:flex;align-items:center;gap:10px;font-weight:700}
  .brand img{width:24px;height:24px}
  .tabs{display:flex;gap:10px;margin-left:8px;overflow:auto}
  .tab{white-space:nowrap;padding:10px 16px;border-radius:12px;background:transparent;color:var(--muted);
       text-decoration:none;display:inline-flex;align-items:center;gap:8px;position:relative}
  .tab.active{color:var(--text);background:#1b2230}
  .tab.active::after{content:"";position:absolute;left:12px;right:12px;bottom:4px;height:3px;border-radius:3px;background:var(--primary)}

  /* Cards / sections */
  h1,h2{margin:0 0 10px}
  .card{background:var(--panel);border:1px solid #1f2733;border-radius:16px;padding:16px}
  .muted{color:var(--muted)}

  /* Market controls */
  .row{display:flex;flex-wrap:wrap;gap:12px}
  .field{flex:1 1 220px;min-width:220px}
  .input, select{width:100%;background:#0e1420;border:1px solid #263143;border-radius:12px;color:var(--text);padding:12px 14px}
  .seg{display:flex;gap:8px;flex-wrap:wrap}
  .seg button{background:var(--pill);color:var(--text);border:1px solid #2a3545;border-radius:12px;padding:10px 14px}
  .seg button.active{background:var(--primary);border-color:var(--primary)}
  .tv-wrap{margin-top:12px;border-radius:14px;border:1px solid #212b39;overflow:hidden;background:#0c111b}
  .tv-chart{width:100%;height:540px}
  .small{font-size:12px;color:var(--muted);text-align:right;margin-top:6px}

  /* Pages */
  .page{display:none;margin-top:16px}
  .page.active{display:block}

  @media (max-width:640px){
    .tv-chart{height:480px}
  }
</style>
</head>
<body>

<!-- NAVBAR -->
<div class="nav">
  <div class="wrap nav-inner">
    <div class="brand">
      <img src="https://cdn-icons-png.flaticon.com/512/2721/2721279.png" alt="logo">
      JK Trading Hub
    </div>
    <div class="tabs" id="tabs">
      <a class="tab active" data-page="home" href="#home">Home</a>
      <a class="tab" data-page="market" href="#market">Market</a>
      <a class="tab" data-page="trade" href="#trade">Trade</a>
      <a class="tab" data-page="discover" href="#discover">Discover</a>
      <a class="tab" data-page="account" href="#account">My Account</a>
    </div>
  </div>
</div>

<div class="wrap">

  <!-- HOME -->
  <section id="home" class="page active">
    <div class="card">
      <h1>JK Trading Hub</h1>
      <p class="muted">Welcome! Navbar हमेशा top पर रहेगा. नीचे वाले Market tab में live chart है — pair और timeframe बदलते ही update होगा.</p>
    </div>
  </section>

  <!-- MARKET -->
  <section id="market" class="page">
    <div class="card">
      <h1>Market</h1>

      <div class="row" style="margin-top:8px">
        <div class="field">
          <label class="muted">Pair</label>
          <select id="mPair" class="input">
            <option>BTC/USDT</option>
            <option>ETH/USDT</option>
            <option>SOL/USDT</option>
            <option>XRP/USDT</option>
          </select>
        </div>
      </div>

      <div class="seg" style="margin-top:10px">
        <button data-tf="1">1m</button>
        <button data-tf="5" class="active">5m</button>
        <button data-tf="15">15m</button>
        <button data-tf="60">1h</button>
        <button data-tf="240">4h</button>
      </div>

      <div class="tv-wrap">
        <div id="tv" class="tv-chart"></div>
      </div>
      <div class="small">Compact mode — top toolbar &amp; left tools hidden for clean view.</div>
    </div>
  </section>

  <!-- TRADE (placeholder) -->
  <section id="trade" class="page">
    <div class="card"><h1>Trade</h1><p class="muted">Yahan aap later order UI आदि जोड़ सकते हो.</p></div>
  </section>

  <!-- DISCOVER (placeholder/news area ready) -->
  <section id="discover" class="page">
    <div class="card"><h1>Discover</h1><p class="muted">Crypto / Gold / Crude news widgets यहाँ add कर सकते हैं.</p></div>
  </section>

  <!-- ACCOUNT (placeholder) -->
  <section id="account" class="page">
    <div class="card"><h1>My Account</h1><p class="muted">User details / API keys आदि.</p></div>
  </section>

</div>

<!-- ====== SPA + TradingView logic ====== -->
<script>
/* ---------- SPA Navigation ---------- */
const pages = [...document.querySelectorAll('.page')];
const tabs  = [...document.querySelectorAll('.tab')];

function showPage(name){
  pages.forEach(p => p.classList.toggle('active', p.id === name));
  tabs.forEach(t => t.classList.toggle('active', t.dataset.page === name));
  if(name==='market') setTimeout(tryMountOnVisible, 30);
}
function hashRoute(){
  const name = (location.hash.replace('#','') || 'home');
  showPage(name);
}
window.addEventListener('hashchange', hashRoute);
document.addEventListener('DOMContentLoaded', hashRoute);

/* ---------- TradingView Chart ---------- */
let tvWidget = null;

// "ETH/USDT" -> "ETHUSDT:BINANCE"
function tvSymbol(txt){
  let p = (txt || 'BTC/USDT').replace(/\s/g,'').toUpperCase();
  p = p.replace('/','');
  if(!/USDT$/.test(p)) p += 'USDT';
  return p + ':BINANCE';
}
function setActiveTFButton(btn){
  const wrap = document.querySelector('#market .seg');
  if(!wrap) return;
  [...wrap.children].forEach(x => x.classList.remove('active'));
  if(btn) btn.classList.add('active');
}
function mountTV(){
  if(tvWidget) return;
  const pairSel = document.getElementById('mPair');
  const sym = tvSymbol(pairSel ? pairSel.value : 'BTC/USDT');

  tvWidget = new TradingView.widget({
    autosize:true,
    symbol:sym,
    interval:"5",
    timezone:"Etc/UTC",
    theme:"dark",
    style:"1",
    locale:"en",
    container_id:"tv",
    hide_top_toolbar:true,
    allow_symbol_change:false,
    withdateranges:false,
    calendar:false
  });

  // highlight default TF
  const defBtn = document.querySelector('#market .seg button.active');
  if(defBtn) setActiveTFButton(defBtn);
}
function tryMountOnVisible(){
  const market = document.getElementById('market');
  if(!market) return;
  const visible = getComputedStyle(market).display!=='none' && market.offsetParent!==null;
  if(visible){ mountTV(); return; }
  const obs = new MutationObserver(() => {
    const v = getComputedStyle(market).display!=='none' && market.offsetParent!==null;
    if(v){ mountTV(); obs.disconnect(); }
  });
  obs.observe(market,{attributes:true,attributeFilter:['class','style']});
}

// pair change
document.addEventListener('change', (e)=>{
  if(e.target && e.target.id==='mPair'){
    if(!tvWidget) return;
    tvWidget.chart().setSymbol(tvSymbol(e.target.value), ()=>{});
  }
});
// timeframe change
document.addEventListener('click', (e)=>{
  const btn = e.target.closest('#market .seg button[data-tf]');
  if(!btn) return;
  if(!tvWidget) return;
  setActiveTFButton(btn);
  tvWidget.chart().setResolution(btn.dataset.tf, ()=>{});
});

// first load
document.addEventListener('DOMContentLoaded', ()=>{
  if(location.hash.replace('#','')==='market') tryMountOnVisible();
});
</script>
</body>
</html>
